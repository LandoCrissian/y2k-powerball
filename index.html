<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>GL1TCHBALL // Y2K ARCADE</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;900&display=swap" rel="stylesheet" />

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCJwqDFZtf1PkZwAalOaf2_7eWtej5HIfA",
      authDomain: "y2k-arcade.firebaseapp.com",
      projectId: "y2k-arcade",
      storageBucket: "y2k-arcade.appspot.com",
      messagingSenderId: "1063043176357",
      appId: "1:1063043176357:web:20bc22e9cbf269ff40fa4c"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>

  <style>
    :root {
      --bg-primary: #0a0a0f;
      --bg-surface: #16161e;
      --text-primary: #ffffff;
      --text-secondary: rgba(255,255,255,0.7);
      --accent-primary: #00ffe1;
      --accent-secondary: #ff00f7;
      --error: #ff4444;
      --success: #00ff9d;
      --gradient-glitch: linear-gradient(45deg, var(--accent-primary), var(--accent-secondary));
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    html {
      background-color: var(--bg-primary);
      height: -webkit-fill-available;
    }

    body {
      min-height: 100vh;
      min-height: -webkit-fill-available;
      background: var(--bg-primary);
      color: var(--text-primary);
      font-family: 'Orbitron', system-ui, -apple-system, sans-serif;
      line-height: 1.5;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }

    .main-container {
      min-height: 100vh;
      padding: 20px;
      padding-bottom: env(safe-area-inset-bottom, 20px);
    }

    .app-container {
      max-width: 480px;
      margin: 0 auto;
      position: relative;
      width: 100%;
    }

    .glitch-header {
      text-align: center;
      margin-bottom: 32px;
      padding-top: 20px;
    }

    .connect-btn {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 24px;
      padding: 12px 24px;
      color: var(--text-primary);
      font-size: 16px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
      min-height: 48px;
      min-width: 200px;
      justify-content: center;
    }

    .connect-btn:active {
      transform: scale(0.98);
      background: rgba(255,255,255,0.1);
    }

    .connect-dot {
      width: 10px;
      height: 10px;
      background: var(--error);
      border-radius: 50%;
      display: inline-block;
    }

    .connect-btn.connected .connect-dot {
      background: var(--success);
    }

    .glitch-title {
      font-size: clamp(32px, 8vw, 42px);
      font-weight: 900;
      letter-spacing: 2px;
      margin: 24px 0 8px;
      background: var(--gradient-glitch);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .glitch-subtitle {
      font-size: 14px;
      color: var(--text-secondary);
      letter-spacing: 4px;
      margin-bottom: 24px;
    }

    .next-draw {
      background: var(--bg-surface);
      border-radius: 12px;
      padding: 16px;
      display: inline-block;
      min-width: 200px;
    }

    .draw-label {
      font-size: 12px;
      color: var(--text-secondary);
      margin-bottom: 4px;
    }

    .draw-timer {
      font-size: 24px;
      color: var(--accent-primary);
      font-family: monospace;
    }

    .token-pots {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      margin-bottom: 24px;
    }

    .pot {
      background: var(--bg-surface);
      border-radius: 16px;
      padding: 20px;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .pot-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .pot-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
    }

    .pot-label {
      font-size: 16px;
      color: var(--text-secondary);
    }

    .pot-amount {
      font-size: 24px;
      font-weight: 700;
      color: var(--accent-primary);
    }

    .coming-soon {
      background: var(--bg-surface);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      margin-top: 24px;
    }

    .coming-soon h2 {
      color: var(--accent-primary);
      margin-bottom: 8px;
      font-size: 20px;
    }

    .coming-soon p {
      color: var(--text-secondary);
      margin-bottom: 16px;
      font-size: 14px;
    }

    .features {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .feature {
      background: rgba(255,255,255,0.05);
      padding: 16px;
      border-radius: 8px;
      font-size: 16px;
    }

    .network-status {
      position: fixed;
      bottom: env(safe-area-inset-bottom, 20px);
      left: 20px;
      right: 20px;
      background: var(--bg-surface);
      padding: 16px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      border: 1px solid rgba(255,255,255,0.1);
      z-index: 1000;
      max-width: 480px;
      margin: 0 auto;
      transition: all 0.3s ease;
    }

    .status-text {
      font-size: 14px;
      color: var(--text-secondary);
    }

    @media (min-width: 481px) {
      .token-pots {
        grid-template-columns: 1fr 1fr;
      }
    }
  </style>
</head>

    <body ontouchstart="">
  <main class="main-container">
    <div class="app-container">

      <!-- üß† CONNECT WALLET + HEADER -->
      <div class="glitch-header">
        <div class="connect-wrapper">
          <button id="connectBtn" class="connect-btn" role="button">
            <span class="connect-dot"></span>
            <span class="connect-text">CONNECT WALLET</span>
          </button>
        </div>
        <h1 class="glitch-title">GL1TCHBALL</h1>
        <div class="glitch-subtitle">VAULT PROTOCOL</div>
        <div class="next-draw">
          <div class="draw-label">NEXT DRAW</div>
          <div id="drawTimer" class="draw-timer">00:00:00</div>
        </div>
      </div>

      <!-- ü™ô TOKEN POTS -->
      <div class="token-pots">
        <div class="pot y2k-pot">
          <div class="pot-header">
            <img src="https://raw.githubusercontent.com/LandoCrissian/y2k-powerball/refs/heads/main/IMG_5445.jpeg" alt="Y2K" class="pot-icon" loading="lazy">
            <span class="pot-label">Y2K POT</span>
          </div>
          <div class="pot-amount" id="y2kPotAmount">Loading...</div>
        </div>

        <div class="pot dojo-pot">
          <div class="pot-header">
            <img src="https://raw.githubusercontent.com/LandoCrissian/y2k-powerball/refs/heads/main/IMG_6584.jpeg" alt="DOJO" class="pot-icon" loading="lazy">
            <span class="pot-label">DOJO POT</span>
          </div>
          <div class="pot-amount" id="dojoPotAmount">Loading...</div>
        </div>
      </div>

      <!-- ‚è≥ COMING SOON -->
      <div class="coming-soon">
        <h2>ENTRY SYSTEM COMING SOON</h2>
        <p>Pick your numbers and enter the next draw</p>
        <div class="features">
          <div class="feature">üéÆ 6 Numbers</div>
          <div class="feature">üíé 50 CRO Entry</div>
          <div class="feature">üèÜ Dual Token Rewards</div>
        </div>
      </div>

      <!-- üë§ VAULT PROFILE & CTA ZONE -->
      <div id="vaultProfileContainer" style="margin-top: 24px;"></div>
      <div id="vaultCTAContainer" style="margin-top: 24px;"></div>
      <div id="vaultFOMOContainer" style="margin-top: 24px;"></div>

      <!-- üì° NETWORK STATUS -->
      <div id="networkStatus" class="network-status">
        <div class="status-icon">üì°</div>
        <div class="status-text">Ready to Connect</div>
      </div>

    </div>
  </main>

        <script>
// ===== Constants =====
const CRONOS_CHAIN_ID = '0x19';
const CRONOS_RPC = 'https://evm.cronos.org';
const Y2K_TOKEN = '0xB4Df7d2A736Cc391146bB0dF4277E8F68247Ac6d';
const DOJO_TOKEN = '0x6Eb1d264Ceb70Fb38b41893Ac6043087E75c3ae4';
const POT_WALLET = '0x348c2F06C64b4465f90446Fd806aFf3A01220450';
const VAULT_URL = 'https://y2k-the-vault.netlify.app/';
const REQUIRED_Y2K = 4_000_000;

// ===== Token ABI =====
const TOKEN_ABI = [{
  "constant": true,
  "inputs": [{ "name": "_owner", "type": "address" }],
  "name": "balanceOf",
  "outputs": [{ "name": "balance", "type": "uint256" }],
  "type": "function"
}];

// ===== State =====
let state = {
  connected: false,
  address: null,
  chainId: null
};

// ===== Init =====
document.addEventListener('DOMContentLoaded', () => {
  setupListeners();
  startDrawTimer();
  checkWalletAvailability();
});

function setupListeners() {
  document.getElementById('connectBtn').addEventListener('click', handleConnect);
}

function checkWalletAvailability() {
  if (window.ethereum) {
    updateStatus('Ready to Connect');
    listenToWalletEvents();
  } else {
    updateStatus('Please Install Web3 Wallet');
  }
}

function listenToWalletEvents() {
  ethereum.on('accountsChanged', () => window.location.reload());
  ethereum.on('chainChanged', () => window.location.reload());
}

// ===== Wallet Connect Flow =====
async function handleConnect() {
  if (!window.ethereum) return updateStatus('Please Install Web3 Wallet');
  try {
    const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
    const chainId = await ethereum.request({ method: 'eth_chainId' });
    if (chainId !== CRONOS_CHAIN_ID) await switchToCronos();

    state.address = accounts[0];
    state.connected = true;
    updateConnectUI();
    updateStatus('Connected ‚úÖ');

    await updatePotBalances();
    await checkVaultProfile(state.address);

  } catch (err) {
    console.error(err);
    updateStatus('Connection Failed');
  }
}

async function switchToCronos() {
  try {
    await ethereum.request({
      method: 'wallet_switchEthereumChain',
      params: [{ chainId: CRONOS_CHAIN_ID }]
    });
  } catch (error) {
    if (error.code === 4902) {
      await ethereum.request({
        method: 'wallet_addEthereumChain',
        params: [{
          chainId: CRONOS_CHAIN_ID,
          chainName: 'Cronos Mainnet',
          nativeCurrency: { name: 'CRO', symbol: 'CRO', decimals: 18 },
          rpcUrls: [CRONOS_RPC],
          blockExplorerUrls: ['https://cronoscan.com/']
        }]
      });
    }
  }
}

function updateConnectUI() {
  const btn = document.getElementById('connectBtn');
  btn.classList.add('connected');
  btn.querySelector('.connect-text').textContent = `${state.address.slice(0, 4)}...${state.address.slice(-4)}`;
  btn.querySelector('.connect-dot').style.background = 'var(--success)';
}

function updateStatus(msg) {
  document.querySelector('.status-text').textContent = msg;
}

// ===== Timer =====
function startDrawTimer() {
  function tick() {
    const now = new Date();
    const draw = new Date();
    draw.setUTCHours(24, 0, 0, 0);
    if (draw <= now) draw.setDate(draw.getDate() + 1);
    const diff = draw - now;
    const h = String(Math.floor(diff / 3.6e6)).padStart(2, '0');
    const m = String(Math.floor((diff % 3.6e6) / 6e4)).padStart(2, '0');
    const s = String(Math.floor((diff % 6e4) / 1000)).padStart(2, '0');
    document.getElementById('drawTimer').textContent = `${h}:${m}:${s}`;
  }
  tick();
  setInterval(tick, 1000);
}

// ===== Pot Balances =====
async function updatePotBalances() {
  try {
    const encoded = (addr) => `0x70a08231000000000000000000000000${POT_WALLET.slice(2).padStart(64, '0')}`;
    const decode = (hex) => parseInt(hex, 16) / 1e18;

    const [y2k, dojo] = await Promise.all([
      fetch(CRONOS_RPC, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          jsonrpc: '2.0', method: 'eth_call',
          params: [{ to: Y2K_TOKEN, data: encoded(Y2K_TOKEN) }, 'latest'],
          id: 1
        })
      }).then(res => res.json()),

      fetch(CRONOS_RPC, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          jsonrpc: '2.0', method: 'eth_call',
          params: [{ to: DOJO_TOKEN, data: encoded(DOJO_TOKEN) }, 'latest'],
          id: 2
        })
      }).then(res => res.json())
    ]);

    const y2kBal = Math.floor(decode(y2k.result)).toLocaleString();
    const dojoBal = Math.floor(decode(dojo.result)).toLocaleString();
    document.getElementById('y2kPotAmount').textContent = `${y2kBal} Y2K`;
    document.getElementById('dojoPotAmount').textContent = `${dojoBal} DOJO`;
  } catch (err) {
    console.error('Pot error:', err);
    document.getElementById('y2kPotAmount').textContent = 'Error';
    document.getElementById('dojoPotAmount').textContent = 'Error';
  }
}

// ===== Vault Profile & CTA Logic =====
async function checkVaultProfile(wallet) {
  try {
    const doc = await db.collection('users').doc(wallet).get();
    if (doc.exists) {
      const data = doc.data();
      renderProfile(data);
    } else {
      const holdsEnough = await checkY2KBalance(wallet);
      if (holdsEnough) renderCreateProfileCTA();
      else renderFOMO();
    }
  } catch (err) {
    console.error('Vault check error:', err);
  }
}

function renderProfile(data) {
  const { username, xHandle, badgeColor, games = 0, wins = 0, earnings = 0 } = data;
  document.getElementById('vaultProfileContainer').innerHTML = `
    <div style="background: var(--bg-surface); padding: 16px; border-radius: 12px;">
      <div style="font-weight: 600; color: ${badgeColor}; margin-bottom: 8px;">üë§ ${username}</div>
      <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 8px;">üß† ${xHandle}</div>
      <div style="display: flex; flex-wrap: wrap; gap: 12px; font-size: 13px;">
        <div>üéÆ Games: <strong>${games}</strong></div>
        <div>üèÜ Wins: <strong>${wins}</strong></div>
        <div>üí∞ Y2K: <strong>${earnings}</strong></div>
      </div>
    </div>
  `;
}

function renderCreateProfileCTA() {
  document.getElementById('vaultCTAContainer').innerHTML = `
    <div style="background: var(--bg-surface); padding: 20px; border-radius: 12px; text-align: center;">
      <div style="margin-bottom: 12px;">üéüÔ∏è You qualify for a Vault profile!</div>
      <a href="${VAULT_URL}" target="_blank" style="background: var(--accent-primary); color: black; padding: 10px 20px; border-radius: 8px; display: inline-block; font-weight: bold;">
        Create Your Player Profile
      </a>
    </div>
  `;
}

function renderFOMO() {
  document.getElementById('vaultFOMOContainer').innerHTML = `
    <div style="background: var(--bg-surface); padding: 20px; border-radius: 12px; text-align: center;">
      <div style="margin-bottom: 12px; font-size: 14px; color: var(--text-secondary);">üõë You don‚Äôt hold enough Y2K to enter draws.</div>
      <div style="font-weight: bold; font-size: 16px; color: var(--accent-secondary);">Hold 4,000,000+ Y2K to unlock full access!</div>
    </div>
  `;
}

async function checkY2KBalance(wallet) {
  try {
    const call = await fetch(CRONOS_RPC, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        jsonrpc: '2.0',
        method: 'eth_call',
        params: [{
          to: Y2K_TOKEN,
          data: `0x70a08231000000000000000000000000${wallet.slice(2).padStart(64, '0')}`
        }, 'latest'],
        id: 9
      })
    }).then(res => res.json());

    const balance = parseInt(call.result, 16) / 1e18;
    return balance >= REQUIRED_Y2K;
  } catch (err) {
    console.error('Y2K balance check failed:', err);
    return false;
  }
}
</script>

        <!-- CTA Containers -->
<div id="vaultProfileContainer" class="profile-section" style="margin-top: 24px;"></div>
<div id="vaultCTAContainer" class="cta-section" style="margin-top: 24px;"></div>
<div id="vaultFOMOContainer" class="fomo-section" style="margin-top: 24px;"></div>

</div> <!-- .app-container -->
</main> <!-- .main-container -->
</body>
</html>
